{% extends "note_layout.html" %}

{% block contents %}
<div style="padding: 2rem; max-width: 900px; margin: 0 auto;">
    <div style="background: white; border-radius: 20px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); overflow: hidden; margin-bottom: 2rem;">
        <!-- Header -->
        <div style="background: linear-gradient(135deg, rgb(132, 204, 22) 0%, rgb(163, 230, 53) 100%); color: white; padding: 2rem; text-align: center;">
            <h1 style="margin: 0; font-size: 1.75rem;">ğŸ“ ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒãƒ¼ãƒˆ</h1>
        </div>
        
        <!-- Body -->
        <div style="padding: 2rem;">
            <!-- Access Form Section -->
            <div style="background: #f9fafb; border-radius: 16px; padding: 1.5rem; margin-bottom: 2rem;">
                <h3 style="margin-top: 0; color: #374151;">ãƒ«ãƒ¼ãƒ ã«ã‚¢ã‚¯ã‚»ã‚¹</h3>
                
                <!-- Tab Buttons -->
                <div style="display: flex; background: #e5e7eb; border-radius: 8px; margin-bottom: 1rem;">
                    <button type="button" onclick="switchTab('join')" id="join-btn" style="flex: 1; padding: 0.75rem; background: rgb(163, 230, 53); color: white; border: none; border-radius: 8px 0 0 8px; cursor: pointer; font-weight: 600;">
                        ãƒ«ãƒ¼ãƒ ã«å‚åŠ 
                    </button>
                    <button type="button" onclick="switchTab('create')" id="create-btn" style="flex: 1; padding: 0.75rem; background: #e5e7eb; color: #6b7280; border: none; border-radius: 0 8px 8px 0; cursor: pointer; font-weight: 600;">
                        æ–°è¦ãƒ«ãƒ¼ãƒ ä½œæˆ
                    </button>
                </div>
                
                <!-- Join Form -->
                <div id="join-tab">
                    <form method="POST" action="/search_note_room_process">
                        <div style="margin-bottom: 1rem;">
                            <label style="display: block; font-weight: 600; margin-bottom: 0.5rem;">Room ID</label>
                            <input type="text" name="id" placeholder="ãƒ«ãƒ¼ãƒ IDã‚’å…¥åŠ›" required 
                                   style="width: 100%; padding: 0.75rem; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 1rem;">
                        </div>
                        <div style="margin-bottom: 1rem;">
                            <label style="display: block; font-weight: 600; margin-bottom: 0.5rem;">Password</label>
                            <input type="password" name="password" placeholder="6æ¡ã®æ•°å­—" required 
                                   style="width: 100%; padding: 0.75rem; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 1rem;">
                        </div>
                        <button type="submit" style="width: 100%; padding: 1rem; background: linear-gradient(135deg, rgb(132, 204, 22) 0%, rgb(163, 230, 53) 100%); color: white; border: none; border-radius: 8px; font-size: 1.1rem; font-weight: 600; cursor: pointer;">
                            ğŸ” ãƒ«ãƒ¼ãƒ ã«å‚åŠ 
                        </button>
                    </form>
                </div>
                
                <!-- Create Form -->
                <div id="create-tab" style="display: none;">
                    <form method="POST" action="/create_note_room">
                        <div style="margin-bottom: 1rem;">
                            <label style="display: block; font-weight: 600; margin-bottom: 0.5rem;">Room ID</label>
                            <input type="text" name="id" placeholder="æ–°ã—ã„ãƒ«ãƒ¼ãƒ IDã‚’å…¥åŠ›" required 
                                   style="width: 100%; padding: 0.75rem; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 1rem;">
                        </div>
                        <button type="submit" style="width: 100%; padding: 1rem; background: linear-gradient(135deg, rgb(132, 204, 22) 0%, rgb(163, 230, 53) 100%); color: white; border: none; border-radius: 8px; font-size: 1.1rem; font-weight: 600; cursor: pointer;">
                            ğŸš€ ãƒ«ãƒ¼ãƒ ã‚’ä½œæˆ
                        </button>
                    </form>
                </div>
            </div>
            
            <!-- Demo Editor -->
            <div style="margin-bottom: 1rem;">
                <label style="display: block; font-weight: 600; margin-bottom: 0.75rem; font-size: 1.1rem;">å…±æœ‰ãƒãƒ¼ãƒˆï¼ˆæœ€å¤§5000æ–‡å­—ï¼‰</label>
                <textarea readonly placeholder="ã“ã“ã«å…¥åŠ›ã™ã‚‹ã¨1ç§’ã”ã¨ã«åŒæœŸã•ã‚Œã¾ã™â€¦&#10;&#10;ãƒ‡ãƒ¢ãƒ†ã‚­ã‚¹ãƒˆ:&#10;ã“ã®ã‚ˆã†ã«ãƒ¡ãƒ³ãƒãƒ¼å…¨å“¡ãŒãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§&#10;åŒã˜ãƒãƒ¼ãƒˆã‚’ç·¨é›†ã§ãã¾ã™ã€‚&#10;&#10;ãƒ»æ–‡å­—ã‚’å…¥åŠ›ã™ã‚‹ã¨å³åº§ã«ä»–ã®ãƒ¡ãƒ³ãƒãƒ¼ã«åŒæœŸ&#10;ãƒ»æœ€å¤§5000æ–‡å­—ã¾ã§å…¥åŠ›å¯èƒ½&#10;ãƒ»ç·¨é›†çŠ¶æ³ãŒãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§è¡¨ç¤º"
                          style="width: 100%; height: 200px; padding: 1rem; border: 2px solid #e5e7eb; border-radius: 12px; font-size: 1rem; background: #f3f4f6; color: #6b7280; resize: vertical; font-family: monospace; line-height: 1.6;"></textarea>
                <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 0.5rem;">
                    <small style="color: #6b7280;">ä¸Šè¨˜ã®ãƒ•ã‚©ãƒ¼ãƒ ã§ãƒ«ãƒ¼ãƒ ã‚’ä½œæˆãƒ»å‚åŠ ã™ã‚‹ã¨ç·¨é›†ã§ãã¾ã™</small>
                    <span style="padding: 0.25rem 0.75rem; background: #6c757d; color: white; border-radius: 12px; font-size: 0.75rem; font-weight: 600;">Demo Mode</span>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Usage Section -->
    <div style="background: white; border-radius: 20px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); overflow: hidden;">
        <div style="background: linear-gradient(135deg, rgb(132, 204, 22) 0%, rgb(163, 230, 53) 100%); color: white; padding: 1.5rem; text-align: center;">
            <h5 style="margin: 0;">ä½¿ã„æ–¹</h5>
        </div>
        <div style="padding: 2rem;">
            <p style="margin: 0; line-height: 1.6;">
                ã“ã®ãƒ«ãƒ¼ãƒ ã§ã¯ãƒ†ã‚­ã‚¹ãƒˆã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã«å…±æœ‰ã§ãã¾ã™ã€‚<br>
                ä¸Šè¨˜ã®ãƒ•ã‚©ãƒ¼ãƒ ã§ãƒ«ãƒ¼ãƒ ã‚’ä½œæˆã¾ãŸã¯å‚åŠ ã™ã‚‹ã¨ã€ãƒ«ãƒ¼ãƒ IDã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã€QRã‚³ãƒ¼ãƒ‰ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚<br>
                ã‚¨ãƒ‡ã‚£ã‚¿ã«å…¥åŠ›ã™ã‚‹ã¨1ç§’ã”ã¨ã«è‡ªå‹•ä¿å­˜ãƒ»åŒæœŸã•ã‚Œã€å¤‰æ›´ã¯ã™ãã«åæ˜ ã•ã‚Œã¾ã™ã€‚<br>
                æœ€å¤§5000æ–‡å­—ã¾ã§å…¥åŠ›å¯èƒ½ã§ã™ã€‚
            </p>
        </div>
    </div>
</div>

<!-- Spinner overlay -->
<div id="spinner-overlay" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0, 0, 0, 0.5); display: none; justify-content: center; align-items: center; z-index: 9999;">
    <div style="text-align: center;">
        <div style="width: 60px; height: 60px; border: 6px solid #f3f3f3; border-top: 6px solid rgb(163, 230, 53); border-radius: 50%; animation: spin 1s linear infinite;"></div>
        <div style="margin-top: 1rem; color: white; font-size: 1.1rem;">å‡¦ç†ä¸­...</div>
    </div>
</div>

<style>
@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}
</style>

<script>
function switchTab(tabName) {
    // Hide all tabs
    document.getElementById('join-tab').style.display = 'none';
    document.getElementById('create-tab').style.display = 'none';
    
    // Reset button styles
    document.getElementById('join-btn').style.background = '#e5e7eb';
    document.getElementById('join-btn').style.color = '#6b7280';
    document.getElementById('create-btn').style.background = '#e5e7eb';
    document.getElementById('create-btn').style.color = '#6b7280';
    
    // Show selected tab and highlight button
    if (tabName === 'join') {
        document.getElementById('join-tab').style.display = 'block';
        document.getElementById('join-btn').style.background = 'rgb(163, 230, 53)';
        document.getElementById('join-btn').style.color = 'white';
    } else {
        document.getElementById('create-tab').style.display = 'block';
        document.getElementById('create-btn').style.background = 'rgb(163, 230, 53)';
        document.getElementById('create-btn').style.color = 'white';
    }
}

function showSpinner() {
    document.getElementById('spinner-overlay').style.display = 'flex';
}

function hideSpinner() {
    document.getElementById('spinner-overlay').style.display = 'none';
}

// Ensure spinner is hidden on page load
document.addEventListener('DOMContentLoaded', function() {
    hideSpinner();
    
    // Add form submission handlers
    document.querySelector('#join-tab form').addEventListener('submit', function(e) {
        e.preventDefault();
        showSpinner();
        this.submit();
    });
    
    document.querySelector('#create-tab form').addEventListener('submit', function(e) {
        e.preventDefault();
        showSpinner();
        this.submit();
    });
});

// Hide spinner if form submission fails (user navigates back)
window.addEventListener('pageshow', function(event) {
    if (event.persisted) {
        hideSpinner();
    }
});
</script>
{% endblock %}