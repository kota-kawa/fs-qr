Webアプリとスケジューラーの不具合を修正しました。

**原因:**
1.  **データベース接続の枯渇 (主な原因):**
    `Note` 機能のリアルタイム通信（WebSocket）において、ユーザーがページを開いている間、データベース接続が解放されずに維持され続ける実装になっていました。これにより、同時接続数が増えるとデータベースの接続プール（上限約60）が枯渇し、他のユーザーや機能（FSQR, Groupなど）が接続待ち状態でフリーズ（スピナーが回り続ける）していました。

2.  **スケジューラーのエラー:**
    バックグラウンドで期限切れファイルを削除する `scheduler.py` が、処理のたびに異なるイベントループを作成しながらデータベース接続プールを使い回していたため、2回目以降の実行でエラーが発生する状態でした。

**修正内容:**
1.  **`Note/note_ws.py`**:
    WebSocket通信のループ内で、データベース操作が終わるたびに即座に接続を解放するように変更しました。これにより、長時間ページを開いていても接続を占有しなくなります。

2.  **`scheduler.py`**:
    定期実行処理が終了するたびにデータベース接続プールをリセットするように修正しました。これにより、日次処理などが正常に動作し続けるようになります。

これらの修正により、数日経過してもサーバーが応答しなくなる問題は解消されるはずです。再デプロイして様子を見てください。